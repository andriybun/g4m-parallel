parallel version of g4m model